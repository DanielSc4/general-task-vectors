Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
[x] Loading dataset, len: 1167
microsoft/phi-2 on cuda device
[x] Found mean_activations at: ./output/sentiment_mean_activations_microsoft-phi-2.pt
  0%|          | 0/24 [00:00<?, ?it/s]Processing original model:   0%|          | 0/24 [00:00<?, ?it/s]You're using a CodeGenTokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:02<00:02,  2.63s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:02<00:00,  1.28s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:02<00:00,  1.48s/it]
/home/ubuntu/document/general-task-vectors/.venv/lib/python3.10/site-packages/bitsandbytes/autograd/_functions.py:322: UserWarning: MatMul8bitLt: inputs will be cast from torch.float32 to float16 during quantization
  warnings.warn(f"MatMul8bitLt: inputs will be cast from {A.dtype} to float16 during quantization")
Processing edited model (l: 0/32, h: 0/32):   0%|          | 0/24 [00:07<?, ?it/s]Processing edited model (l: 0/32, h: 1/32):   0%|          | 0/24 [00:09<?, ?it/s]Processing edited model (l: 0/32, h: 2/32):   0%|          | 0/24 [00:11<?, ?it/s]Processing edited model (l: 0/32, h: 3/32):   0%|          | 0/24 [00:13<?, ?it/s]Processing edited model (l: 0/32, h: 4/32):   0%|          | 0/24 [00:15<?, ?it/s]Processing edited model (l: 0/32, h: 5/32):   0%|          | 0/24 [00:17<?, ?it/s]Processing edited model (l: 0/32, h: 6/32):   0%|          | 0/24 [00:19<?, ?it/s]Processing edited model (l: 0/32, h: 7/32):   0%|          | 0/24 [00:21<?, ?it/s]Processing edited model (l: 0/32, h: 8/32):   0%|          | 0/24 [00:23<?, ?it/s]Processing edited model (l: 0/32, h: 9/32):   0%|          | 0/24 [00:25<?, ?it/s]Processing edited model (l: 0/32, h: 10/32):   0%|          | 0/24 [00:27<?, ?it/s]Processing edited model (l: 0/32, h: 11/32):   0%|          | 0/24 [00:29<?, ?it/s]Processing edited model (l: 0/32, h: 12/32):   0%|          | 0/24 [00:31<?, ?it/s]Processing edited model (l: 0/32, h: 13/32):   0%|          | 0/24 [00:33<?, ?it/s]Processing edited model (l: 0/32, h: 14/32):   0%|          | 0/24 [00:35<?, ?it/s]Processing edited model (l: 0/32, h: 15/32):   0%|          | 0/24 [00:37<?, ?it/s]Processing edited model (l: 0/32, h: 16/32):   0%|          | 0/24 [00:39<?, ?it/s]Processing edited model (l: 0/32, h: 17/32):   0%|          | 0/24 [00:41<?, ?it/s]Processing edited model (l: 0/32, h: 18/32):   0%|          | 0/24 [00:43<?, ?it/s]Processing edited model (l: 0/32, h: 19/32):   0%|          | 0/24 [00:45<?, ?it/s]Processing edited model (l: 0/32, h: 20/32):   0%|          | 0/24 [00:47<?, ?it/s]Processing edited model (l: 0/32, h: 21/32):   0%|          | 0/24 [00:49<?, ?it/s]Processing edited model (l: 0/32, h: 22/32):   0%|          | 0/24 [00:51<?, ?it/s]Processing edited model (l: 0/32, h: 23/32):   0%|          | 0/24 [00:53<?, ?it/s]Processing edited model (l: 0/32, h: 24/32):   0%|          | 0/24 [00:55<?, ?it/s]Processing edited model (l: 0/32, h: 25/32):   0%|          | 0/24 [00:57<?, ?it/s]Processing edited model (l: 0/32, h: 26/32):   0%|          | 0/24 [00:59<?, ?it/s]Processing edited model (l: 0/32, h: 27/32):   0%|          | 0/24 [01:01<?, ?it/s]Processing edited model (l: 0/32, h: 28/32):   0%|          | 0/24 [01:03<?, ?it/s]Processing edited model (l: 0/32, h: 29/32):   0%|          | 0/24 [01:05<?, ?it/s]Processing edited model (l: 0/32, h: 30/32):   0%|          | 0/24 [01:07<?, ?it/s]Processing edited model (l: 0/32, h: 31/32):   0%|          | 0/24 [01:09<?, ?it/s]Processing edited model (l: 1/32, h: 0/32):   0%|          | 0/24 [01:11<?, ?it/s] Processing edited model (l: 1/32, h: 1/32):   0%|          | 0/24 [01:13<?, ?it/s]Processing edited model (l: 1/32, h: 2/32):   0%|          | 0/24 [01:15<?, ?it/s]Processing edited model (l: 1/32, h: 3/32):   0%|          | 0/24 [01:17<?, ?it/s]